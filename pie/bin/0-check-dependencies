#!/bin/bash -e

fatal () {
  echo "$@" >&2
  exit 1
}

if [[ -z "$API_KEY" || -z "$ACCOUNT" ]]
  then
    fatal "Your Conjur API Key and/or Account are missing from the environment."
fi

[[ -n `which cf` ]] || fatal "Cloud Foundry command line tool not found in \$PATH - read the README!"
[[ `cf dev status | head -n1` -eq 'Running' ]] || cf dev start

echo "You are ready to run the demo."